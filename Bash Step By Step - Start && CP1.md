## **Bash** Step By Step

> ç¿»è¯‘ï¼šBashæˆ‘TMç¤¾ä¿ â€”â€” æŸä¸æ„¿æ„é€éœ²å§“åçš„Ass We Canå¤§ä½¬(çº¯è™šæ„)

### ç¼˜ç”±

è¿™ä¸ªæœˆæˆ‘åŸæœ¬æ˜¯ä¸ºäº†å¡«ä¸€ä¸ªMusicAppçš„å‘ï¼Œå‡†å¤‡å…¥Kotlinçš„ã€‚æŒ‰ç…§ä¹‹å‰çš„ç»éªŒï¼Œå­¦ä¹ è¯­è¨€çš„åˆæœŸåˆ·é¢˜æ˜¯ä¸€ä¸ªå¯¹æé«˜ç†Ÿç»ƒåº¦éå¸¸æœ‰å¸®åŠ©çš„æ–¹æ³•ï¼Œä½†æ˜¯å½“æˆ‘ç‚¹å¼€CWçš„è¯­è¨€åˆ†ç±»çš„æ—¶å€™ï¼Œæˆ‘æƒŠå–œå¾—å‘ç°æœ‰Bashè¿™ä¸ªshellã€‚å¥½â€œéª‘â€å¿ƒçˆ†æ£šçš„æˆ‘ç‚¹è¿›äº†Bashçš„é¢˜åº“éšä¾¿ç‚¹å¼€äº†ä¸€é“ï¼Œç„¶åå°±è’™ä½äº†ã€‚æˆ‘å¯¹ä¸èµ·å½“å¹´çš„ç³»ç»Ÿè¯¾ä¸Šçš„linuxè€å¸ˆï¼Œå¯¹ä¸èµ·ä½œä¸šï¼Œæˆ‘å†³å®šæŠŠBashæ¡èµ·æ¥ã€‚ï¼ˆKotlinå‘¢ï¼ŒMusicAppå‘¢ï¼Ÿ



### èµ·æ‰‹å¼ 

**Useful resources**

*PS: Mac only, Sorry for the proletariat.*

- [Update Bash In Mac By Brew](http://clubmate.fi/upgrade-to-bash-4-in-mac-os-x/)
- [é…åˆiterm2çš„é«˜äº®](https://superuser.com/questions/399594/color-scheme-not-applied-in-iterm2)
- [Bash Guide](http://guide.bash.academy/) ç›®å‰åœ¨çœ‹çš„å°±æ˜¯è¿™ä¸ª




## Bash Guide Notes ğŸ“’

> Bash Guide: http://guide.bash.academy/commands/

### The Chapter: Commands And Arguments

**é¢„å¤‡çŸ¥è¯†:**

1. æŒ‡ä»¤å—ä½¿ç”¨å¤§æ‹¬å·åŒ…è£¹, `{ command1; command2 }`

2. ExecæŒ‡ä»¤: æ–°å¼€ä¸€ä¸ªè¿›ç¨‹ï¼Œä»£æ›¿ç°æœ‰çš„è¿›ç¨‹ã€‚å…·ä½“å¯è§ [Link](https://askubuntu.com/questions/525767/what-does-an-exec-command-do)

3. **FD, File Descriptor**

   bashä¸­æœ‰ä¸€ä¸ªè›®é‡è¦çš„æ¦‚å¿µâ€”â€”File Descriptor(åç®€ç§°FD)ï¼ŒFDæ˜¯bashç¨‹åºå’Œå¤–ç•Œäº¤äº’çš„ä¸€ä¸ªæŠ½è±¡ï¼Œå¸¸è§çš„æœ‰FD0(æ ‡å‡†è¾“å…¥)ã€FD1(æ ‡å‡†è¾“å…¥)ã€FD2(æ ‡å‡†Error)ã€‚å¯ä»¥å‚è€ƒä¸‹å›¾ï¼š

   ![File Descriptor](http://guide.bash.academy/img/streams.png)



**å¯èƒ½ä¼šæœ‰ç”¨çš„æƒ…æŠ¥:**

Bashä¼šä¸ºæ¯æ¡`æŒ‡ä»¤`åˆ›å»ºä¸€ä¸ª`subshell`ï¼Œè¿™ä¸ªä¼šæ”¾åœ¨åé¢è®²è§£





#### å°èŠ‚: åŸºæœ¬è¯­æ³•(Syntax)

**Syntax**

1. `[ something ]` æŒ‡æ˜¯å¯é€‰çš„
2. `[ FORMAT ...]` æŒ‡é‡å¤å¤šä¸ªè¿™ä¸ªæ ¼å¼æ˜¯åˆæ³•çš„

**Command**

> åŸºæœ¬å½¢å¼:  `[ç¯å¢ƒå˜é‡ ...] æŒ‡ä»¤å [å‚æ•° ...] [FDé‡å®šå‘ ...]`

**List ä¸€ä¸²Commands**

> åŸºæœ¬å½¢å¼ :  `command control-operator[ commadn2 control-operator ... ]`	

æ§åˆ¶æ“ä½œç¬¦åŒ…å«  `|| && ;` `||`åœ¨å‰è€…æ‰§è¡Œå¤±è´¥çš„æ—¶å€™è°ƒç”¨ï¼Œ`;`åœ¨å‰è€…æ‰§è¡Œç»“æŸä¹‹åè°ƒç”¨, `&&`åœ¨å‰è€…æ‰§è¡ŒæˆåŠŸä¹‹åè°ƒç”¨

**Compound Command æ··åˆCommand**

> åŸºæœ¬å½¢å¼:  `if list [ ;|<newline> ] then list [ ;|<newline> ] fi` æˆ– `{ list ; }`

**Coprocesses å¼‚æ­¥Command**

> åŸºæœ¬å½¢å¼:  `coproc [ name ] command [ redirection ... ]`

ä¼šåœ¨ä½¿ç”¨è¿™ä¸ª`$name`çš„æ—¶å€™å»è¿è¡Œè¿™ä¸ªæŒ‡ä»¤å¹¶æ‹¿åˆ°å³æ—¶çš„ç»“æœ

**Functions**

> åŸºæœ¬å½¢å¼: `name () compound-command [ redirection ]`

()å†…æ²¡æœ‰å‚æ•°ï¼Œä¸€ç›´ä¸ºç©ºï¼Œæ‹¿å‚æ•°ç›´æ¥ç”¨$1, $2å³å¯ã€‚é¡ºä¾¿è¯´ä¸€ä¸‹: `$$ - PID`, `$! - åå°PID`, `$? - exit code`, `$* - å‚æ•°åˆ—è¡¨ ç©ºæ ¼åˆ†å‰²`, `$@ - å‚æ•°åˆ—è¡¨ å›è½¦åˆ†å‰²`, `$# å‚æ•°ä¸ªæ•°`

**Pipeline**  

> åŸºæœ¬å½¢å¼: `[time [-p]] [ ! ] command [ [|æˆ–|&] cmmand2 ... ]`

çœ‹ä¸ªä¾‹å­

```bash
$ echo Hello | rev
# output: olleH

$ rm doesntexistfile |& rev
# output: yrotcerid ro elif hcus oN :eliftsixetnseod :mr

$ time echo Hello
# output: Hello <newline><newline> echo 0m0.004s etc...

# ! å…³é”®å­—æš‚æ—¶æ²¡æœ‰è®¨è®ºåˆ°ï¼Œå¾…è¡¥å……
```

`Pipeline`å…·ä½“åšçš„äº‹æƒ…å°±æ˜¯ï¼šæŠŠå‰ä¸€æ¡æŒ‡ä»¤çš„FD1,2ï¼ŒæŒ‡å‘äº†ä¸‹ä¸€è·³æŒ‡ä»¤çš„FD0;

ä¸”æœ‰`cm1 | cm2` ï¼Œ`cm1 |& cm2`ä¸¤ç§å½¢å¼ã€‚ç¬¬äºŒç§æˆ‘è¿˜æ˜¯ç¬¬ä¸€æ¬¡çŸ¥é“å‘¢/doge



#### å°èŠ‚: Simple commands

**Command**

æŒ‡ä»¤åï¼šBashä¼šæ ¹æ® `æŒ‡ä»¤å` å»æŸ¥æ‰¾ `å·²å®šä¹‰çš„fn` , `builtin-fn` æˆ– `$PATH` é‡Œæœ‰çš„ç¨‹åºå»æ‰§è¡Œï¼Œtypeå¯ä»¥æŸ¥æ‰¾æŒ‡ä»¤çš„æ‰€åœ¨ä½ç½® â€”â€” `type command`ã€‚

å‚æ•°ï¼šcommandåé¢çš„å‚æ•°ç”¨ç©ºæ ¼åˆ†å‰²ï¼Œå­—ç¬¦ä¸²ä¸­æœ‰ç©ºæ ¼ç”¨`"`, `'`åŒ…è£¹æˆ–è€…ç”¨`\`è½¬ä¹‰ç©ºæ ¼ã€‚å­—ç¬¦ä¸²`""` å†…å¯åŒ…è£¹å˜é‡`$variable` æˆ– å‘½ä»¤`$(command)`

è¯·åŠ¡å¿…ç•™æ„å¼•å·çš„ä½¿ç”¨ï¼Œæœ‰ä¸ªå±é™©çš„ä¾‹å­å¯ä»¥çœ‹çœ‹

```bash
$ read -p 'Which user would you like to remove from your system ?' username
# Something Print ...?  lucifa

$ rm -vr /home/$username
# Broken! this command will be:
# -> rm -vr /home/ lucifa
```



**Redirection! **

>  DING, å·²è·å¾—æƒ…æŠ¥å¦‚ä¸‹ï¼š

1. `command >File` å¯ä»¥æŠŠæŒ‡ä»¤çš„FD1æŒ‡å‘File

2. `command 2>File` å¯ä»¥æŠŠæŒ‡ä»¤çš„FD2æŒ‡å‘File

3. `/dev ` ä¸‹å­˜æ”¾çš„æ˜¯ç›´æ¥æŒ‡å‘ç³»ç»Ÿè®¾å¤‡çš„æ–‡ä»¶, `/dev/null` åˆ™æ˜¯å…¶ä¸­ä¸€ä¸ªç‰¹æ®Šçš„å­˜åœ¨ï¼Œè¿™ä¸ªæ–‡ä»¶ä¸ç®¡å†™ï¼Œä¸€ç›´ä¸ºç©ºã€‚å¯ä»¥æŠŠä¸åœ¨æ„çš„é”™è¯¯ä¿¡æ¯æŒ‡å‘è¿™ä¸ªæ–‡ä»¶ã€‚

4. å½“ä½ å¾ˆç†æ‰€å½“ç„¶å¾—ä½¿ç”¨å¦‚ä¸‹æ“ä½œæ—¶ï¼Œå…¶å®æƒ…å†µéå¸¸å±é™©âš ï¸

   ```bash
   $ ls -l a b >myfiles.ls 2>mayflies.ls
   # ç†æƒ³çŠ¶æ€åº”è¯¥æ˜¯ï¼ŒæŠŠæ­£å¸¸è¾“å…¥å†™åˆ°myfiles, ç„¶åï¼ŒæŠŠé”™è¯¯ä¿¡æ¯å†™åˆ°åé¢
   # å®é™…ç»“æœå´å¦‚ä¸‹
   # -rw-r--r--  1 lhunath  stls: b: No such file or directoryaff  0 30 Apr 14:43 a
   # æ··ä¹±çš„ç»“æœ
   ```

   å› ä¸ºä¸¤ä¸ªFDåŒæ—¶æ‰“å¼€äº†è¿™ä¸ªæ–‡ä»¶æµï¼Œæ‰€ä»¥å¯¼è‡´æ··åˆçš„ç»“æœã€‚æ­£ç¡®çš„æ“ä½œå¦‚ä¸‹

   ```bash
   $ ls -l a b >myfiles.ls 2>&1
   # ä½¿ç”¨ >& æ“ä½œç¬¦ï¼Œè®©FD2æŒ‡å‘FD1çš„æ–‡ä»¶æµ
   ```

5. `[x]>file, [x]<file` æŒ‡ä»¤çš„FD1æŒ‡å‘æ–‡ä»¶ï¼ŒæŒ‡ä»¤çš„FD0ä»æ–‡ä»¶è¾“å…¥

6. `[x]>&y æˆ– [x]<&y` å¤åˆ¶æ–‡ä»¶æŒ‡å‘æµï¼Œåè€…çš„ä½¿ç”¨åœºæ™¯è¿˜æ²¡çœ‹åˆ°, ä½†åœ¨SOæŸä¸ªé—®é¢˜ä¸­çœ‹åˆ°ï¼Œå‰åä¸¤è€…çš„æ•ˆæœå‡ ä¹ä¸€æ · [Link](https://unix.stackexchange.com/questions/120532/what-does-exec-31-do)

7. `x>&-, x<&-` ç”¨`-`å»æŒ‡å‘ï¼Œå³æ˜¯å…³é—­è¿™ä¸ªFD

8. `[x]>&y-, [x]<&y-`  æ˜¯ `[x]>&y y>&-` çš„è¯­æ³•ç³–

9. `[x]>>file` Appending æ–‡ä»¶æŒ‡å‘

10. `[x]&>file` åŒæ—¶é‡å®šå‘FD1ï¼ŒFD2åˆ°File

11. `[x]<>file` æŠŠFD0, FD1éƒ½æŒ‡å‘ä¸€ä¸ªæ–‡ä»¶

    ```bash
    $ exec 3>&1 >mylog; echo moo; exec 1>&3 3>&-
    # è¿™ä¸ªåœ°æ–¹å…ˆæŠŠå½“å‰è¿›ç¨‹çš„FD1 copy åˆ°FD3æ¥ï¼Œç„¶åæŠŠFD1æŒ‡å‘ä¸€ä¸ªæ–‡ä»¶
    # æ¥ç€æ¥ä¸€å‘echoï¼Œç­‰äºæ˜¯æŠŠè¾“å‡ºå€¼å†™åˆ°æ–‡ä»¶ï¼Œæœ€åç»“æŸçš„æ—¶å€™exec
    # é‡æ–°æŠŠFD1æŒ‡å›ä¸€å¼€å§‹çš„Displayï¼ŒæŠŠFD3æŠ›å¼ƒæ‰
    ```

12. Here Documents

    ```
    command <<[-]åˆ†éš”ç¬¦(.)
    	Documents
    åˆ†éš”ç¬¦
    ```

    ç›´æ¥æŠŠåˆ†éš”ç¬¦å†…çš„å†…å®¹ä¼ è¾“ç»™`æŒ‡ä»¤`çš„FD0, å¸¦ä¸Š`-`å°±æ˜¯å¿½ç•¥å†…å®¹æ¯è¡Œå¼€å¤´çš„ç©ºæ ¼ã€‚

13. Here Strings, ç±»ä¼¼å‰ä¸€ä¸ªï¼Œæ›´ç²¾ç®€ä¸€äº›ï¼Œ`<<<string `å³å¯